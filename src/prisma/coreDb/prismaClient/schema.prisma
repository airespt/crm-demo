generator client {
  provider = "prisma-client-js"
  output   = "prismaClient"
}

generator typescriptInterfaces {
  provider = "prisma-generator-typescript-interfaces"
}

datasource db {
  provider = "sqlserver"
  url      = env("CORE_DB")
}

model User {
  id        Int             @id @default(autoincrement())
  name      String
  email     String          @unique
  password  String          @default("")
  createdAt DateTime        @default(now())
  createdBy Int
  updatedAt DateTime?       @default(now())
  updatedBy Int
  roleId    Int
  role      RolePermissions @relation(fields: [roleId], references: [id])

  @@map(name: "Users")
}

model RolePermissions {
  id              Int    @id @default(autoincrement())
  name            String @unique
  //  isAdmin               Boolean     @default(false)
  userAccounts    Int    @default(0)
  rolePermissions Int    @default(0)
  customers       Int    @default(0)
  users           User[]
}

model VistaGroup {
  groupId        String   @id
  favouriteVista String   @default("")
  vistas         Vistas[]
}

model Vistas {
  groupId String
  group   VistaGroup @relation(fields: [groupId], references: [groupId])
  vistaId String
  label   String     @db.NVarChar(50)
  fields  String     @db.NVarChar(4000) // JSON array of Fields assigned to this vista

  @@id(fields: [groupId, vistaId])
}

// model Vistas {
//   groupId             String      @db.NVarChar(50)
//   vistaName           String      @db.NVarChar(50)
//   fields              FieldsOnVistas[]
//   @@id(fields: [groupId, vistaName])
// }

// model SageFields {
//   tableKey            String    @db.NVarChar(50)
//   fieldKey            String    @db.NVarChar(100)
//   vistas              FieldsOnVistas[]
//   @@id([tableKey, fieldKey])
// }

// model FieldsOnVistas {
//   groupId             String    @db.NVarChar(50)
//   vistaName           String    @db.NVarChar(50)
//   vista               Vistas    @relation(fields: [groupId, vistaName], references: [groupId, vistaName])
//   tableKey            String    @db.NVarChar(50)
//   fieldKey            String    @db.NVarChar(100)
//   field               SageFields @relation(fields: [tableKey, fieldKey], references: [tableKey, fieldKey])
//   @@id([groupId, vistaName, tableKey, fieldKey])

//   label               String    @db.NVarChar(50) @default("")
//   //width               Int       @default(100)
//   //order               Int       @default(0)
// }
